!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.navaid=e()}(this,function(){var t="/";function e(t){t+="State";var e=history[t];history[t]=function(n){var r=new Event(t.toLowerCase());return r.uri=n,e.apply(this,arguments),dispatchEvent(r)}}return function(n,r){var u,a=[],i={},o={},s=o.format=function(t){return t?(t="/"+t.replace(/^\/|\/$/g,""),u?u.test(t)&&(t.replace(u,"")||"/"):t):t};return"/"===(n=s(n))&&(n=""),n&&(u=new RegExp("^/?"+n.substring(1)+"(?=/|$)","i")),o.route=function(t,e){history[(e?"replace":"push")+"State"](n+t,null,n+t)},o.on=function(e,n){i[e]=n;var r=function(e){var n,r,u,a=e.split(t);""===a[0]&&a.shift();for(var i,o=0,s=[],c="";o<a.length;o++)0!==(u=(i=a[o]).length)&&(42===(n=i.charCodeAt(0))?(s.push("wild"),c+=t+"(.*)"):58===n?(r=63===i.charCodeAt(u-1),s.push(i.substring(1,r?u-1:u)),c+=r?"(?:/([^/]+?))?":t+"([^/]+?)"):c+=t+i);return s.length&&(c+="(?:/)?"),{keys:s,pattern:c=new RegExp("^"+c+"/?$","i")}}(e);return r.route=e,a.push(r),o},o.run=function(t){t=s(t||location.pathname);var e=a.find(function(e){return e.pattern.test(t)});if(e){for(var n=0,u={},c=e.pattern.exec(t);n<e.keys.length;)u[e.keys[n]]=c[++n]||null;i[e.route](u)}else t&&r&&r(t);return o},o.listen=function(){function t(t){o.run(t.uri)}function n(t){var e,n=t.target.closest("a");n&&n.href&&!n.target&&(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button||(e=s(n.getAttribute("href")))&&(t.preventDefault(),o.route(e)))}e("push"),e("replace");var r=removeEventListener;return addEventListener("popstate",t),addEventListener("replacestate",t),addEventListener("pushstate",t),addEventListener("click",n),o.unlisten=function(){r("popstate",t),r("replacestate",t),r("pushstate",t),r("click",n)},o.run()},o}});
